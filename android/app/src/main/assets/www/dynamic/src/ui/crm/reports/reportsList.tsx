function module(e,t,n){var r,l,a,i,o,u,c,s,f,d,m,p,g,b,E,v,y,h,k,C,S,L,R,I,j,D,w,A,F,x;n.link("@babel/runtime/regenerator",{default:function(e){r=e}},0),n.link("@babel/runtime/helpers/typeof",{default:function(e){l=e}},1),n.link("@babel/runtime/helpers/objectSpread2",{default:function(e){a=e}},2),n.link("@babel/runtime/helpers/slicedToArray",{default:function(e){i=e}},3),n.link("react",{default:function(e){o=e},useRef:function(e){u=e},useState:function(e){c=e}},0),n.link("moment/moment",{default:function(e){s=e}},1),n.link("react-intl",{FormattedMessage:function(e){f=e},useIntl:function(e){d=e}},2),n.link("meteor/meteor",{Meteor:function(e){m=e}},3),n.link("react-toastify",{toast:function(e){p=e}},4),n.link("@material-ui/icons/MonetizationOn",{default:function(e){g=e}},5),n.link("@material-ui/icons/FilterList",{default:function(e){b=e}},6),n.link("@material-ui/core/CardContent",{default:function(e){E=e}},7),n.link("@material-ui/icons/Print",{default:function(e){v=e}},8),n.link("../../components/crm/ChipProject",{default:function(e){y=e}},9),n.link("../../components/crm/ChipLabel",{default:function(e){h=e}},10),n.link("../../components/UserAvatar",{default:function(e){k=e}},11),n.link("../../components/crm/FilterSelectProjects",{default:function(e){C=e}},12),n.link("../../components/crm/FilterSelectLabels",{default:function(e){S=e}},13),n.link("../../components/crm/FilterSelectUsers",{default:function(e){L=e}},14),n.link("../../components/crm/MaterialTable",{default:function(e){R=e}},15),n.link("../../components/FilterColumns",{default:function(e){I=e}},16),n.link("../../../lib/table/alterColumns",{default:function(e){j=e}},17),n.link("../../components/Button",{default:function(e){D=e}},18),n.link("../../../lib/dates/displayDate",{default:function(e){w=e},DateFormat:function(e){A=e}},19),n.link("@material-ui/lab/Alert",{default:function(e){F=e}},20),n.link("../../../lib/users/haveSub",{default:function(e){x=e}},21);var M=function(e){return F.error(e.error)},T=function(){return F.success("updated")},B=function(){var e=c(!1),t=i(e,2),n=t[0],B=t[1],O=c(!1),P=i(O,2),z=P[0],H=P[1],U=c(!1),_=i(U,2),$=_[0],N=_[1],Y=c(["timeRemaining"]),q=i(Y,2),G=q[0],J=q[1],K,Q=d().formatMessage,V=u(),W=function(){function e(){var e;return r.async(function(){function t(t){for(;;)switch(t.prev=t.next){case 0:return e=V.current.state.originalData.map((function(e){return e._id})),B(!0),t.next=4,r.awrap(m.promise("teams.reports.generatePdfReport",e).then((function(e){e.length>0&&e.forEach((function(e){var t="data:application/pdf;base64,"+e.base64,n=document.createElement("a"),r="report"+e.name+".pdf";n.href=t,n.download=r,n.click()})),p.success(Q({id:"success"}))})).catch((function(e){return p.error(e.message)})).finally((function(){B(!1)})));case 4:case"end":return t.stop()}}return t}(),null,null,null,Promise)}return e}(),X=function(){function e(e,t){var n;return r.async(function(){function l(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,r.awrap(m.promise("teams.reports.getAllCall",{options:e,selector:t,paginated:!0}));case 2:return n=l.sent,l.abrupt("return",{totalCount:n.totalCount,page:n.page,data:n.data.map((function(e){var t=e.hours.map?e.hours.map((function(e){var t=w(e.startDate,A.HOURONLY),n=w(e.endDate,A.HOURONLY);return o.createElement("div",{key:t+n,style:{display:"flex",alignItems:"center"}},t," - ",n,!!e.billable&&o.createElement(g,{width:20,heigth:20,color:"primary",style:{margin:4}}))})):o.createElement("div",null),n=0;return e.hours.forEach((function(e){var t=s.utc(e.startDate),r=s.utc(e.endDate),l=s.duration(r.diff(t));n+=l.asSeconds()})),a(a({},e),{},{time:t,date:e.date,duration:s.utc("2015-01-01").startOf("day").seconds(n).format("H:mm")})}))});case 4:case"end":return l.stop()}}return l}(),null,null,null,Promise)}return e}(),Z=[{title:Q({id:"ReportList.Project"}),field:"projectId",searchable:!0,filterComponent:C,render:function(e){return o.createElement(y,{key:e.projectId,projectId:e.projectId})}},{title:"Label",field:"label",searchable:!0,filterComponent:S,render:function(e){return o.createElement(h,{key:e.label,labelId:e.label})}},{title:Q({id:"ReportList.User"}),field:"createdBy",filterComponent:L,render:function(e){return o.createElement("div",{key:e.createdBy,style:{display:"flex",alignItems:"center"}},o.createElement(k,{userId:e.createdBy,disableCalculationAvailable:!0}))}},{title:"Date",field:"date",defaultSort:"desc",customSort:function(e,t){var n=s.utc(e),r=s.utc(t);return n.isBefore(r)?1:n.isAfter(r)?-1:0},type:"date"},{title:Q({id:"ReportList.TimeReported"}),field:"time",filtering:!1,sorting:!1,render:function(e){return o.createElement("div",null,o.createElement("b",null,"Total: ",e.duration),e.time)}},{title:"Message",field:"message",filtering:!1,sorting:!1,render:function(e){return o.createElement("div",{style:{width:"30vw"}},!!e.message&&o.createElement("div",null,o.createElement("div",{style:{margin:4}},o.createElement("div",{dangerouslySetInnerHTML:{__html:e.message}}))),!!e.messageInternal&&o.createElement("div",null,o.createElement("div",null,"Message interne"),o.createElement(E,null,o.createElement("div",{dangerouslySetInnerHTML:{__html:e.messageInternal}}))))}},{title:Q({id:"ReportList.TimeRemaining"}),field:"timeRemaining",filtering:!1,sorting:!1}];return o.createElement(R,{tableRef:V,loading:n,columns:j(Z,G),data:function(e){return new Promise((function(t){var n,r={};e.filters.length>0&&e.filters.forEach((function(e){e.value&&e.value.length>0&&"object"===l(e.value)?r[e.column.field]={$in:e.value}:e.value&&e.value.length>0&&"string"==typeof e.value?r[e.column.field]={$regex:e.value}:e.value&&"object"===l(e.value)&&"date"===e.column.property&&(r[e.column.field]={$gte:s.utc(e.value).startOf("day").toDate(),$lt:s.utc(e.value).endOf("day").toDate()})}));var i=e.orderBy?{sort:(n={},n[e.orderBy.field]="asc"===e.orderDirection?1:-1,n)}:{};X(a(a({skip:e.pageSize*e.page,limit:e.pageSize},i),{},{search:e.search}),r).then((function(e){e.data.length>0?N(!0):N(!1),t({data:e.data,page:e.page,totalCount:e.totalCount})}))}))},onError:M,onSuccess:T,options:{padding:"dense",showTitle:!1,columnsButton:!1,filtering:z},components:{Empty:function(){return o.createElement("div",null,o.createElement("br",null),o.createElement("br",null),o.createElement("br",null),o.createElement("b",null,o.createElement(f,{id:"Reports.Empty"})),o.createElement("br",null),o.createElement("br",null),o.createElement("br",null),o.createElement(F,{severity:"info"},o.createElement(f,{id:"Reports.TipsAdd"})),o.createElement("br",null))},Actions:function(){return o.createElement(o.Fragment,null,o.createElement(I,{style:{marginLeft:16},columns:j(Z,G),onColumnsChanged:J}),o.createElement(D,{id:"button-filter-project",onClick:function(){return H(!z)},size:"small",color:z?"secondary":"default",variant:"outlined",style:{marginLeft:16}},o.createElement(b,{fontSize:"small"}),"  ",o.createElement(f,{id:"Actions.Filtrer"})),o.createElement(D,{id:"button-filter-project",onClick:function(){return W()},size:"small",color:"default",variant:"outlined",style:{marginLeft:16},disabled:!$,blockedFeature:!x("standard"),placement:"left"},o.createElement(v,{fontSize:"small"}),"  ",o.createElement(f,{id:"Actions.Export"})))}}})};n.exportDefault(B)}

