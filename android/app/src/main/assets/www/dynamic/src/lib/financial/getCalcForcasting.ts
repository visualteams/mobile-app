function module(e,n,t){var a,o,u,r,i,l;t.link("@babel/runtime/helpers/objectSpread2",{default:function(e){a=e}},0),t.link("@babel/runtime/helpers/toConsumableArray",{default:function(e){o=e}},1),t.export({NOMBRE_MOIS_MAX:function(){return s},NOMBRE_JOUR_VENDU_PAR_MOIS:function(){return c},categoryUnplannned:function(){return d}}),t.link("moment",{default:function(e){u=e}},0),t.link("date-fns/differenceInMonths",{default:function(e){r=e}},1),t.link("../../ui/financial/forecasting/lib/calculateAmountExpensePrevision",{default:function(e){i=e}},2),t.link("../../constants/FINANCES",{EnumFrequencyBudget:function(e){l=e}},3);var s=10,c=12,d="unplanned",f=function(e){var n=e.expensesDone,t=e.getListAccountingCode,f=e.categories,p=e.availDevs,v=e.usedHolidays,g=e.developpers,m=e.startDate,x=e.startDateCalculate,h=e.endMonthExpensesReal,b=e.endDatePrevision,E=e.expensePrevision,M=e.formatMessage,D=function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return n.length&&(null===(e=n.filter((function(e){return!!e.startDate})))||void 0===e?void 0:e.find((function(e){return!(null==e||!e.startDate)&&u.utc(e.startDate).isSame(u.utc(m))})))},A=Math.round(Number(Object.values(p).reduce((function(e,n){return e+n.length}),0)));A-=30*g.length-Number(Object.values(v).reduce((function(e,n){return e+n}),0)),A*=.7;var y=u.utc(b).diff(u.utc(h),"months"),C={},N={},_=[],O=0;null==n||n.forEach((function(e){var n;null===(n=e.details)||void 0===n||n.forEach((function(n){var a=t.find((function(e){return String(e.code)===String(n.accountingCode)}));if(null==a||!a.excludeCA){var o,r=null==a?void 0:a.categoryId,i=(null===(o=f.find((function(e){return e._id===r})))||void 0===o?void 0:o._id)||d,l=-parseFloat(String(n.preTaxAmount||n.totalAmount));C[i]=parseFloat(C[i]||0)+l,N[i]||(N[i]=[]),N[i].push({expenseNature:a,name:e.tiersName||e.description,amount:l}),i===d&&_.push(n),u.utc(h).diff(u.utc(e.documentDate),"months")<3&&(O+=l)}}))}));var S={};E.forEach((function(e){var n=i(e);S[e.expenseCategoryId]=S[e.expenseCategoryId]?S[e.expenseCategoryId]+n:n}));var F=0,I=0,R,k=[].concat(o(f),[{_id:d,name:M({id:"ExpenseTable.unplanned"})}]).map((function(e){var n=Math.round(C[e._id]||0),t=N[e._id],o=D(null==e?void 0:e.limits),u=S[e._id]||0,r=o&&0!=o.amount?o.amount:u;F+=r;var i=0;i=(null==o?void 0:o.frequency)===l.MONTHLY?Math.round(r/12*y):n>r||0===y?0:r-Math.abs(n),I+=i;var s=100*n/r,c=100*(n+i)/r,d=Math.round(r-(n+i));return a(a({},e),{},{expensesDetail:t,expenseAlreadyDone:n,expensesForcasting:i,budgetForcasting:u,budgetAllocated:r>0?r:M({id:"ListExpenseCategories.budgetNotDefined"}),pourcentage:s,pourcentageBuffer:c,balance:d})})),B=Object.values(C).reduce((function(e,n){return e+n}),0),j=I+B,T;return{calcCategories:k,TJMwithoutAjust:j/s/g.length/c,totalExpenseReal:B,totalExpensesForcastingTimeReal:j,totalExpensesForcastingNextMonth:I,totalExpensesBudgetAllocated:F,totalDaysAvailable:A,expensesDoneByCode:C,nbMoisRestant:y,expensesUnplanned:_,totalExpensesUnplanned:C.unplanned,totalExpenseLast3Month:O,numberMonthStartExercice:r(x,m)}};t.exportDefault(f)}

