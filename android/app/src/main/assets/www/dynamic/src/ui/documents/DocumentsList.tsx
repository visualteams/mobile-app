function module(e,t,n){var i,r,o,l,u,c,a,d,f,s,m,p,k,E,g,w,y,h,A,b,v,I,C,M,S,_,x,F,B,D,L,K,N,T,P;n.link("@babel/runtime/regenerator",{default:function(e){i=e}},0),n.link("@babel/runtime/helpers/toConsumableArray",{default:function(e){r=e}},1),n.link("@babel/runtime/helpers/objectSpread2",{default:function(e){o=e}},2),n.link("@babel/runtime/helpers/slicedToArray",{default:function(e){l=e}},3),n.link("react",{"*":function(e){u=e}},0),n.link("react",{useEffect:function(e){c=e},useState:function(e){a=e}},1),n.link("react-router-dom",{useHistory:function(e){d=e}},2),n.link("moment",{default:function(e){f=e}},3),n.link("react-toastify",{toast:function(e){s=e}},4),n.link("react-intl",{FormattedMessage:function(e){m=e},useIntl:function(e){p=e}},5),n.link("uniforms-material",{AutoForm:function(e){k=e}},6),n.link("material-ui-confirm",{useConfirm:function(e){E=e}},7),n.link("meteor/meteor",{Meteor:function(e){g=e}},8),n.link("@material-ui/icons/Delete",{default:function(e){w=e}},9),n.link("@material-ui/icons/AddCircle",{default:function(e){y=e}},10),n.link("@material-ui/icons/MenuBook",{default:function(e){h=e}},11),n.link("@material-ui/icons/Folder",{default:function(e){A=e}},12),n.link("@material-ui/core/Tooltip/Tooltip",{default:function(e){b=e}},13),n.link("@material-ui/core/MenuItem/MenuItem",{default:function(e){v=e}},14),n.link("@material-ui/core/Menu/Menu",{default:function(e){I=e}},15),n.link("@material-ui/icons/Visibility",{default:function(e){C=e}},16),n.link("@material-ui/icons/Edit",{default:function(e){M=e}},17),n.link("@material-ui/core/IconButton",{default:function(e){S=e}},18),n.link("../components/crm/MaterialTable",{default:function(e){_=e}},19),n.link("../components/UserAvatar",{default:function(e){x=e}},20),n.link("./KnowledgeBreadcrumb",{default:function(e){F=e}},21),n.link("./FolderRepresentation",{default:function(e){B=e}},22),n.link("./FileRepresentation",{default:function(e){D=e}},23),n.link("../components/AddForm",{default:function(e){L=e}},24),n.link("../../db/knowledge/schema",{default:function(e){K=e}},25),n.link("uniforms-bridge-simple-schema-2",{SimpleSchema2Bridge:function(e){N=e}},26),n.link("../../constants/ROLES",{ROLES:function(e){T=e}},27),n.link("../../lib/users/haveRights",{default:function(e){P=e}},28);var R=function(e){var t=e.match.params.knowledgeId,n=a([]),R=l(n,2),z=R[0],G=R[1],O=a([]),U=l(O,2),V=U[0],W=U[1],j=a(null),H=l(j,2),q=H[0],J=H[1],Q=a(!1),X=l(Q,2),Y=X[0],Z=X[1],$=a({}),ee=l($,2),te=ee[0],ne=ee[1],ie=a(!0),re=l(ie,2),oe=re[0],le=re[1],ue=d(),ce,ae=p().formatMessage,de=E();c((function(){fe()}),[t]);var fe=function(){function e(){var e,n,r;return i.async(function(){function o(o){for(;;)switch(o.prev=o.next){case 0:return le(!0),e=g.promise("documents.read",{selector:{knowledgeId:t}}),n=g.promise("knowledge.read",{selector:{parentId:t}}),o.next=5,i.awrap(Promise.all([e,n]));case 5:r=o.sent,G(r[0]),W(r[1]),le(!1);case 9:case"end":return o.stop()}}return o}(),null,null,null,Promise)}return e}(),se=function(e){return J(e.currentTarget)},me=function(){return J(null)},pe=function(e,t){var n=t._id,i=t.type;return ue.push("folder"===i?"/folder/"+n:"/document/"+n)},ke=function(e){var n=o(o({},e),{},{parentId:t});return ne({}),Z(!1),n._id?g.promise("knowledge.update",n._id,n).then(fe):g.promise("knowledge.create",n).then(fe)},Ee=function(){ne({}),Z(!0),me()},ge=function(e){return function(t){"folder"!==e.type?pe(t,e):(t.stopPropagation(),ne(e),Z(!0))}},we=function(){function e(){return i.async(function(){function e(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",g.promise("documents.create",{title:ae({id:"Knowledge.NewDocName"}),knowledgeId:t}).then((function(e){return ue.push("/document/"+e)})).catch((function(e){return s.error(e.toString())})));case 1:case"end":return e.stop()}}return e}(),null,null,null,Promise)}return e}(),ye=function(e){return function(){return de().then(function(){function t(){return i.async(function(){function t(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.awrap(g.promise("folder"===e.type?"knowledge.delete":"documents.delete",{_id:e._id}));case 2:return t.abrupt("return",fe());case 3:case"end":return t.stop()}}return t}(),null,null,null,Promise)}return t}())}},he=[{title:ae({id:"DocumentsList.name"}),field:"title",render:function(e){return u.createElement("div",{style:{cursor:"pointer"},onClick:function(t){return pe(t,e)}},"folder"===e.type?u.createElement(B,{title:e.title}):u.createElement(D,{title:e.title,type:e.type}))}},{title:ae({id:"DocumentsList.owner"}),field:"ownerId",render:function(e){var t=e.ownerId;return u.createElement(x,{userId:t,disableCalculationAvailable:!0,style:{width:32,height:32}})}},{title:ae({id:"DocumentsList.lastUpdate"}),field:"updatedAt",render:function(e){var t=e.createdAt,n=e.updatedAt;return f.utc(n||t).format("lll")}},{title:"Actions",width:"10",sorting:!1,render:function(e){return u.createElement(u.Fragment,null,P(T.MANAGE_WIKI)&&u.createElement("div",null,u.createElement(b,{title:"folder"===e.type?u.createElement(m,{id:"Actions.Edit"}):u.createElement(m,{id:"Actions.View"})},u.createElement(S,{style:{cursor:"pointer"},onClick:ge(e)},"folder"===e.type?u.createElement(M,null):u.createElement(C,null))),u.createElement(b,{title:u.createElement(m,{id:"Actions.Delete"})},u.createElement(S,{style:{cursor:"pointer"},onClick:ye(e)},u.createElement(w,null)))))}}],Ae=[].concat(r(V.map((function(e){return o(o({},e),{},{type:"folder"})}))),r(z.map((function(e){return o(o({},e),{},{type:"wiki"})})))),be=K.pick("title"),ve=u.createElement(k,{model:te,schema:new N(be)});return u.createElement("div",{style:{paddingTop:32}},u.createElement(L,{form:ve,title:te._id?ae({id:"Knowledge.edit"}):ae({id:"Knowledge.create"}),onClose:function(){return Z(!1)},displayActions:!0,open:!!Y,buttonConfirmLabel:te._id?u.createElement(m,{id:"Actions.Edit"}):u.createElement(m,{id:"Actions.Add"}),onSubmit:ke}),u.createElement(I,{id:"menu-add",anchorEl:q,keepMounted:!0,open:Boolean(q),onClose:me},u.createElement(v,{onClick:Ee},u.createElement(A,{fontSize:"small",color:"primary"}),"  Nouveau dossier"),u.createElement(v,{onClick:we},u.createElement(h,{fontSize:"small"}),"  Nouvelle page")),u.createElement(_,{isLoading:oe,title:u.createElement(F,{knowledgeId:t}),columns:he,data:Ae,options:{paging:!1,filtering:!1,export:!1,columnsButton:!1,exportButton:!1},actions:[{icon:function(){return u.createElement(y,{color:"primary"})},tooltip:u.createElement(m,{id:"Actions.Add"}),isFreeAction:!0,onClick:se,disabled:!P(T.MANAGE_WIKI)}]}))};n.exportDefault(R)}

